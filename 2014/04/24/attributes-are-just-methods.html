<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1'/>
  <title>Jocellyn's Blog  - Attributes are just methods</title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link href="//cdnjs.cloudflare.com/ajax/libs/c3/0.1.29/c3.css" rel="stylesheet" type="text/css">

  <link href='http://fonts.googleapis.com/css?family=Sue+Ellen+Francisco|Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/main.css" rel="stylesheet">
  <meta name="google-site-verification" content="rnwDRfWLERH4z0UoMfWumemvsRSmRIQTz3dd15flK4k" />
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
</head>
<body>


<div id="main" role="main" class="container">
  <div class="row">
    <a href="/"><h1 class="title"> Jocellyn's Blog</h1></a>

    <div class="col-md-3 image menu">
      <a href="/">
        <img src="/images/2.jpeg" class="logo" alt="" />
      </a>
      <h2>Recent Articles</h2>
      <ol>
          <li><a href="/2018/02/21/how-much-for-my-next-uber.html">How much for my next Uber? Light intro to machine learning</a> </li>
          <li><a href="/2018/01/25/simple-game-development-with-pixi.html">The simplest game development with Pixi.js</a> </li>
          <li><a href="/2018/01/25/how-did-i-lost-fear-from-recruiters.html">How did I lose fear from recruiters</a> </li>
          <li><a href="/2017/10/30/where-to-find-remote-job.html">Where to find remote job</a> </li>
          <li><a href="/2017/04/16/why-ruby-is-slow.html">Why Ruby is slow?</a> </li>
          <li><a href="/2016/10/18/why-am-i-leaving-msd.html">Why am I leaving MSD</a> </li>
          <li><a href="/2015/11/13/d3-simple-example.html">D3 simple visualization (Visu homework V)</a> </li>
          <li><a href="/2015/10/29/interesting-visualization.html">Interesting visualization (Visu homework IV.)</a> </li>
          <li><a href="/2015/10/21/what-is-wrong-with-that-graph.html">What is wrong with that graph? (Visu homework III.)</a> </li>
          <li><a href="/2015/10/19/cleaning-data-for-visualization.html">Cleaning data for visualization (Visu homework II.)</a> </li>
      </ol>

      <h2>Tags</h2>
      <ol>
          <li><a href="/tags/machine-learning.html">machine learning (1)</a></li>
          <li><a href="/tags/programming.html">programming (21)</a></li>
          <li><a href="/tags/game-development.html">game development (1)</a></li>
          <li><a href="/tags/javascript.html">javascript (4)</a></li>
          <li><a href="/tags/career.html">career (3)</a></li>
          <li><a href="/tags/ruby.html">ruby (14)</a></li>
          <li><a href="/tags/performance.html">performance (1)</a></li>
          <li><a href="/tags/visualization.html">visualization (6)</a></li>
          <li><a href="/tags/haskell.html">haskell (2)</a></li>
          <li><a href="/tags/rails.html">rails (9)</a></li>
          <li><a href="/tags/mongodb.html">mongodb (2)</a></li>
          <li><a href="/tags/sociology.html">sociology (6)</a></li>
          <li><a href="/tags/self-improvement.html">self-improvement (11)</a></li>
          <li><a href="/tags/eu.html">EU (3)</a></li>
          <li><a href="/tags/education.html">education (3)</a></li>
          <li><a href="/tags/love.html">love (1)</a></li>
      </ol>

      <h2>By Year</h2>
      <ol>
        <li><a href="/2018.html">2018 (3)</a></li>
        <li><a href="/2017.html">2017 (2)</a></li>
        <li><a href="/2016.html">2016 (1)</a></li>
        <li><a href="/2015.html">2015 (6)</a></li>
        <li><a href="/2014.html">2014 (15)</a></li>
        <li><a href="/2013.html">2013 (7)</a></li>
        <li><a href="/2012.html">2012 (8)</a></li>
    </ol>


    </div>
    <div class="col-md-7 articles">
        <div class="single-post">

    <h1>Attributes are just methods</h1>

    <p>I am not sure how many beginners know that, because I did not, but attributes in rails are just a methods.
It is not anything fancy and special, really. Let&rsquo;s explain it with an example.</p>

<p>Imagine situation that you are receiving
params, which are not exactly matching with your model&rsquo;s attributes. (Well, this is of course
nonsense when you are sending the data on your own from a form, but consider sending from
another application via json api).</p>

<p>Your params could look like this:</p>
<div class="highlight"><pre class="highlight plaintext"><code>{user: {name: "Olaf", age: "7", interest: "playing"}}
</code></pre></div>
<p>And your model could look like this:</p>
<div class="highlight"><pre class="highlight plaintext"><code>class User

    field :interests, type: Array
    field :name, type: String
    field :age, type: String

    # Typing fields like this is a MongoDB speciality
    # when using Activerecord you would not have it here,
    # you would see your attributes in db/scheme.
end
</code></pre></div>
<p>Notice, that we are getting one interest from params, but our model stores an array of many interests.
The rest of the attributes are without problems.
When you would like to for example update your current user with those params from above,
you could be tempted to create the custom logic for saving the different parameter in your controller.</p>

<p>Maybe you would call the <code>update_attributes</code> for the rest of the params, and then you would
call <code>user.interests &lt;&lt; params[:interest]</code>.  This is wrong. All your updating should
be handled by one method - <code>update_attributes</code>. So, let&rsquo;s present a solution.</p>

<p>We will take advantage from my initial phrase (&ldquo;attributes are just methods&rdquo;) and create a
virtual, helper attribute called the same way as your param. You need to define its getter and
setter, aka how you will retrieve its value and how you will change it.</p>
<div class="highlight"><pre class="highlight plaintext"><code>class User

    field :interests, type: Array
    field :name, type: String
    field :age, type: String

    def interest
        self.interests[0]
    end

    def interest=(value)
        self.interests &lt;&lt; value
    end
end
</code></pre></div>
<p>Now, when we call <code>interest = something</code> we are actually filling our proper attribute, the right
one (<code>interests</code>). We are encapsulating it by a helper attribute. Why?
Because when we do in our controller:</p>
<div class="highlight"><pre class="highlight plaintext"><code>def update
    user = User.find(params[:id])
    user.update_attributes(params.require(:user).permit(:interest, :name, :age)
end
</code></pre></div>
<p>That will be just enough. Update attributes will call the setter of each of the attributes. It will take a look at:</p>

<ul>
<li>name -&gt; och, it is a attribute so I can save it with the user</li>
<li>age -&gt; och, it is a attribute so I can save it with the user</li>
<li>interest -&gt; hmm, it is not in the fields, but &hellip;! there it is, in my user model at the bottom&hellip; I know how to call interest=!</li>
</ul>

<p>We do not actually have a field &ldquo;interest&rdquo; but we made a setter for it on our own. The <code>update_attribute</code> can proceed.
Who cares, that the setter actually sets a value into a different attribute. It is there, therefore this will work.
How amazing!</p>

    <hr class="space-maker">


    <div class="social-buttons-wrap">
      <div class="social-buttons">
        <div class="inner-buttons">
          <script type="text/javascript" src="http://www.reddit.com/static/button/button2.js"> </script>
          <br>
          <div class="g-plusone" data-size="tall"></div>
          <br>
          <a href="https://twitter.com/share" class="twitter-share-button" data-related="Jocinka" data-lang="en" data-size="medium" data-count="vertical"> Tweet </a>
          <br>
          <div class="fb-like" data-href="http://jocellyn.cz#{current_article.url}" data-layout="box_count" data-action="like" data-show-faces="true" data-share="true"> </div>
        </div>
      </div>
    </div>

    <div class="row well" id="journey">
        <a href="http://journeyapp.net/" target="_blank">
            <div class="col-md-8">
                <h3> Journey - Think. Write. Grow. </h3>
                <p> Self-improvement app which will help you to focus on your emotions, be positive and stay mindful. </p>
            </div>
            <div class="col-md-4">
                <img src="/images/journey.png" class="journey" alt="" />
            </div>
        </a>
    </div>

    <hr class="space-maker">
    <h1>Comments</h1>
    <div class="disqus">
      <div id="disqus_thread"></div>
      <script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'jocellyncz'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
       var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
       dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
       (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
       })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>

    <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-38390510-1', 'jocellyn.cz');
ga('send', 'pageview');

    </script>

    </div>
  </div>
</div>

<div class="invisible">
  <a href="https://plus.google.com/101530780379992796153?rel=author">Google</a>
</div>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-38390510-1', 'jocellyn.cz');
ga('send', 'pageview');

</script>
<script type="text/javascript">
var _gauges = _gauges || [];
(function() {
 var t   = document.createElement('script');
 t.type  = 'text/javascript';
 t.async = true;
 t.id    = 'gauges-tracker';
 t.setAttribute('data-site-id', '5364b096eddd5b1500001191');
 t.src = '//secure.gaug.es/track.js';
 var s = document.getElementsByTagName('script')[0];
 s.parentNode.insertBefore(t, s);
 })();
</script>
</body>
</html>

    <script type="text/javascript">
(function() {
 var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
 po.src = 'https://apis.google.com/js/platform.js';
 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
 })();
    </script>
    <div id="fb-root"></div>
    <script type="text/javascript">
(function(d, s, id) {
 var js, fjs = d.getElementsByTagName(s)[0];
 if (d.getElementById(id)) return;
 js = d.createElement(s); js.id = id;
 js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=301963046612249&version=v2.0";
 fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script>
    </script>
    <script type="text/javascript">
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>
